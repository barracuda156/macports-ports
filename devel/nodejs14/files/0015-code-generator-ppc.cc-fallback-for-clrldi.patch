From d5520e397cf3e4adbca6d4e88b2c5ed2eba97778 Mon Sep 17 00:00:00 2001
From: barracuda156 <vital.had@gmail.com>
Date: Sat, 4 Nov 2023 11:02:12 +0800
Subject: [PATCH 15/17] code-generator-ppc.cc: fallback for clrldi

---
 deps/v8/src/compiler/backend/ppc/code-generator-ppc.cc | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git deps/v8/src/compiler/backend/ppc/code-generator-ppc.cc deps/v8/src/compiler/backend/ppc/code-generator-ppc.cc
index 7a69e8eecae..e39b3e31666 100644
--- deps/v8/src/compiler/backend/ppc/code-generator-ppc.cc
+++ deps/v8/src/compiler/backend/ppc/code-generator-ppc.cc
@@ -1561,12 +1561,20 @@
     case kPPC_MulHigh32:
       __ mulhw(r0, i.InputRegister(0), i.InputRegister(1), i.OutputRCBit());
       // High 32 bits are undefined and need to be cleared.
+#if V8_TARGET_ARCH_PPC64
       __ clrldi(i.OutputRegister(), r0, Operand(32));
+#else
+      __ mr(i.OutputRegister(), r0);
+#endif
       break;
     case kPPC_MulHighU32:
       __ mulhwu(r0, i.InputRegister(0), i.InputRegister(1), i.OutputRCBit());
       // High 32 bits are undefined and need to be cleared.
+#if V8_TARGET_ARCH_PPC64
       __ clrldi(i.OutputRegister(), r0, Operand(32));
+#else
+      __ mr(i.OutputRegister(), r0);
+#endif
       break;
     case kPPC_MulDouble:
       ASSEMBLE_FLOAT_BINOP_RC(fmul, MiscField::decode(instr->opcode()));
