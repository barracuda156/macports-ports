From cb11aaa2a0513e0ff424e0d4c2ae899164e7a0b1 Mon Sep 17 00:00:00 2001
From: barracuda156 <vital.had@gmail.com>
Date: Mon, 21 Nov 2022 01:13:02 +0800
Subject: [PATCH 2/2] core_unix_stubs.c: add legacysupport header for strnlen

---
 core_unix/src/core_unix_stubs.c | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/core_unix/src/core_unix_stubs.c b/core_unix/src/core_unix_stubs.c
index 4beba77..20976d2 100644
--- a/core_unix/src/core_unix_stubs.c
+++ b/core_unix/src/core_unix_stubs.c
@@ -64,6 +64,13 @@
 #include <wordexp.h>
 #endif
 
+#if defined(__APPLE__)
+#include <AvailabilityMacros.h>
+#if MAC_OS_X_VERSION_MAX_ALLOWED <= 1060
+#include <LegacySupport/string.h>
+#endif
+#endif
+
 CAMLprim value core_unix_error_of_code(value code)
 {
   return unix_error_of_code(Int_val(code));
-- 
2.38.1

