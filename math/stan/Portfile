# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem              1.0
PortGroup               github 1.0

github.setup            stan-dev stan 2.30.0 v
categories              math
maintainers             {@barracuda156 gmail.com:vital.had} {@catap korins.ky:kirill} openmaintainer
license                 BSD-3-Clause
description             C++ package for Bayesian inference, maximum likelihood estimation etc.
long_description        ${description}
homepage                https://mc-stan.org
checksums               rmd160  c86bfe4466314935085953af55b5223541c0abe5 \
                        sha256  8db42c801f086df262380da5218708b7d7e4fcf93e16b08021c3c21601d3eca0 \
                        size    3930879
supported_archs         noarch
installs_libs           no

depends_lib-append      port:rapidjson \
                        port:stanmath

set py_ver              3.10
set py_ver_nodot        [string map {. {}} ${py_ver}]

depends_test-append     port:gmake \
                        port:python${py_ver_nodot} \
                        port:py${py_ver_nodot}-setuptools

compiler.cxx_standard   2011

use_configure           no

build                   {}

destroot {
    copy ${worksrcpath}/src/stan ${destroot}${prefix}/include
}

# Tests are not implemented, this is a placeholder.
test.run                yes
test.cmd                "${prefix}/bin/python${py_ver} ./runTests.py"
test.env-append         TBB_LIB="${prefix}/lib/libtbb.dylib"
