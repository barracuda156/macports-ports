--- fiemap.c.orig	2023-02-24 05:51:27.000000000 +0800
+++ fiemap.c	2023-08-24 22:12:58.000000000 +0800
@@ -36,6 +36,8 @@
 # define FITHAW		_IOWR('X', 120, int)	/* Thaw */
 #endif
 
+#ifdef __linux__
+
 char quiet = 0;
 
 int unfreeze_fd = 0;
@@ -438,3 +440,8 @@
 }
 #endif
 
+#else
+
+#warning This sourcefile is broken and will not build. Skipping it.
+
+#endif
